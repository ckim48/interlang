<!-- templates/career_worksheet_4w.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>{{ job|title }} • Week {{ week }}</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<!-- Fonts & Bootstrap -->

<style>
  :root{
    /* Playful pastel palette (same as achievements) */
    --ink:#2a2a2a;
    --muted:#6e7494;
    --bg:#ffffff;
    --bg-wash-1:#fff7f1;  /* peach */
    --bg-wash-2:#f0f7ff;  /* sky */
    --bg-wash-3:#f7fff6;  /* mint */
    --paper:#fffdf5;
    --paper-br:#f2eede;
    --brand:#ff8db3;    /* strawberry */
    --brand-2:#7acbff;  /* sky */
    --brand-3:#7ee0a8;  /* mint */
    --brand-4:#ffd86b;  /* sunshine */
    --ring:#ffdca8;
    --ok:#16a34a;
  }

  /* Background */
  body{
      font-family: Nunito, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    color:var(--ink);
    background:
      radial-gradient(60vmax 40vmax at 8% 0%, var(--bg-wash-2) 0%, transparent 65%),
      radial-gradient(60vmax 40vmax at 92% 4%, var(--bg-wash-1) 0%, transparent 65%),
      radial-gradient(36vmax 28vmax at 50% 100%, var(--bg-wash-3) 0%, transparent 70%),
      #fff;
    background-attachment: fixed;
    padding-bottom: 30px;
  }

  /* Match navbar style (uses your nav.html, just spacing here) */
  .page-wrap{ max-width: 980px; margin: 20px auto 0; }

  /* Header block similar to achievements header */
  .page-header{
    background: linear-gradient(180deg,#ffffff,#fbfcff);
    border:1px solid #f0f2fb; border-radius:22px; padding:18px;
    box-shadow:0 16px 44px rgba(52,90,160,.10); position:relative;
  }
  .page-header::after{
    content:""; position:absolute; left:20px; right:20px; bottom:-1px; height:2px;
    background:linear-gradient(90deg,transparent,#ffdca8,#9fe0ff,transparent);
    border-radius:2px; opacity:.9;
  }
  .crumb{ color:var(--muted); font-size:.95rem; }
  .title{
    font-family:Fredoka; font-weight:900; letter-spacing:.2px; color:#1f2b46;
    margin:0;
  }

  /* Cards */
  .card-glass{
    border:1px solid #f0f2fb;
    background: linear-gradient(180deg,#ffffff,#fbfcff);
    border-radius:20px; box-shadow:0 12px 32px rgba(52,90,160,.10);
  }
  .section-title{
    font-family:Fredoka;
    font-weight:800; font-size:1.1rem; margin-bottom:.5rem; color:#1f2b46;
  }
  .small-note{ font-size:.9rem; color:var(--muted); }

  /* Table */
  table.vocab td, table.vocab th{ vertical-align: top; }

  /* Badges */
  .badge-soft{
    background:linear-gradient(180deg,#fff8e6,#fff3cc);
    border:1px solid #ffe3a3; color:#5e4300; border-radius:999px;
    padding:.2rem .6rem; font-weight:800;
  }

  /* Fun buttons (same set used across pages) */
  .btn-fun{
    border-radius:14px;
    border:1px solid #ffdca8;
    background: linear-gradient(180deg,#fff6e7,#ffe8b3);
    color:#8a5600;
    font-weight:800;
    padding:.55rem 1.1rem;
    display:inline-flex; align-items:center; gap:.4rem;
    min-height:42px;
  }
  .btn-fun:hover{ background: linear-gradient(180deg,#fff1d1,#ffdf99); color:#7a4e00; }
  .btn-fun:disabled, .btn-fun.disabled{ opacity:.6; pointer-events:none; }

  .btn-fun-outline{
    border-radius:14px;
    border:1px dashed #ffdca8;
    background:#fff;
    color:#8a5600;
    font-weight:800;
    padding:.55rem 1.1rem;
    display:inline-flex; align-items:center; gap:.4rem;
    min-height:42px;
  }
  .btn-fun-outline:hover{ background:#fffaf1; border-style:solid; }
  .btn-fun-outline[aria-disabled="true"]{ opacity:.6; pointer-events:none; }

  /* Top action bar (All Weeks / Prev / Next) */
  .action-bar{ display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
  .action-bar .btn-fun, .action-bar .btn-fun-outline{
    padding:8px 16px; min-height:42px;
    text-decoration:none;
  }

  /* Form elements */
  .form-control{
    background:#fff !important; border:1px solid #e6ecff !important;
    border-radius:14px; padding:.65rem .9rem; font-weight:600;
    box-shadow:0 3px 0 rgba(0,0,0,0.02) inset;
  }
  .form-control:focus{
    border-color:#cfe2ff !important; box-shadow:0 0 0 .2rem #cfe2ff66 !important;
  }
  .form-check-input{
    border-radius:.5rem; border:1px solid #e6ecff;
  }
  .form-check-input:focus{ box-shadow:0 0 0 .2rem #cfe2ff66 !important; }
  .form-check-input:checked{
    background:linear-gradient(180deg,#fff6e7,#ffe8b3);
    border-color:#ffdca8;
  }

  /* Bottom bar */
  .bottom-bar{ display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
</style>
</head>
<body>

{% include 'nav.html' %}

<div class="page-wrap container">

  {% set prev_week = 1 if week <= 1 else week - 1 %}
  {% set next_week = 4 if week >= 4 else week + 1 %}

  <!-- Header -->
  <div class="page-header mb-3">
    <div class="d-flex align-items-start justify-content-between gap-3 flex-wrap">
      <div>
        <div class="crumb">
          <a href="{{ url_for('career_overview', ws_id=ws_id) }}" class="text-decoration-none">CareerQuest</a> · {{ job|title }}
        </div>
        <h1 class="title h4">Week {{ week }} Worksheet</h1>
        <div class="text-secondary small">Level {{ level }} • Created {{ created_at }}</div>
      </div>

      <!-- Actions -->
      <div class="action-bar">
        <a class="btn-fun-outline" href="{{ url_for('career_overview', ws_id=ws_id) }}">
          <i class="bi bi-grid"></i> All Weeks
        </a>

        {% if week <= 1 %}
          <a class="btn-fun" aria-disabled="true" tabindex="-1">
            ← Prev
          </a>
        {% else %}
          <a class="btn-fun" href="{{ url_for('career_view', ws_id=ws_id, week=prev_week) }}">
            ← Prev
          </a>
        {% endif %}

        {% if week >= 4 %}
          <a class="btn-fun" aria-disabled="true" tabindex="-1">
            Next →
          </a>
        {% else %}
          <a class="btn-fun" href="{{ url_for('career_view', ws_id=ws_id, week=next_week) }}">
            Next →
          </a>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mb-3">
        {% for cat, msg in messages %}
          <div class="alert alert-{{cat}} mb-2" role="alert">{{ msg }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- Reading -->
  <div class="card-glass p-4 mb-4">
    <div class="section-title">Reading</div>
    <p class="mb-0">{{ reading }}</p>
    <div class="small-note mt-2">Tip: Underline new words. Read twice.</div>
  </div>

  <!-- Vocabulary -->
  {% if vocab %}
  <div class="card-glass p-4 mb-4">
    <div class="section-title">A. Vocabulary (read + copy)</div>
    <div class="table-responsive">
      <table class="table table-sm vocab mb-0">
        <thead>
          <tr>
            <th style="width:18%">Word</th>
            <th style="width:22%">Meaning (KO)</th>
            <th>Example</th>
          </tr>
        </thead>
        <tbody>
          {% for v in vocab %}
          <tr>
            <td class="fw-semibold">{{ v.word }}</td>
            <td>{{ v.meaning_ko }}</td>
            <td>{{ v.example_en }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% endif %}

  <form method="post" action="{{ url_for('career_submit', ws_id=ws_id) }}?week={{ week }}">

    <!-- Comprehension -->
    {% if comprehension %}
    <div class="card-glass p-4 mb-4">
      <div class="section-title">B. Comprehension (short answers)</div>
      {% for c in comprehension %}
        <div class="mb-3">
          <div class="mb-1">{{ loop.index }}. {{ c.q }}</div>
          <input class="form-control" name="comp_{{ loop.index0 }}" placeholder="Answer in a few words">
        </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- MCQ -->
    {% if mcq %}
    <div class="card-glass p-4 mb-4">
      <div class="section-title">C. Multiple Choice (pick one)</div>
      {% for item in mcq %}
        {% set qname = 'mcq_' ~ loop.index0 %}
        <div class="mb-3">
          <div class="mb-1">{{ loop.index }}. {{ item.prompt|safe }}</div>
          <div>
            {% for opt in item.options %}
              <div class="form-check mb-1">
                <input class="form-check-input" type="radio"
                       name="{{ qname }}" id="{{ qname }}_{{ loop.index0 }}"
                       value="{{ loop.index0 }}">
                <label class="form-check-label" for="{{ qname }}_{{ loop.index0 }}">{{ opt }}</label>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- Short blanks -->
    {% if short %}
    <div class="card-glass p-4 mb-4">
      <div class="section-title">D. Short Blanks (one word)</div>
      {% for item in short %}
        <div class="mb-3">
          <div class="mb-1">{{ loop.index }}. {{ item.prompt|safe }}</div>
          <input class="form-control" name="short_{{ loop.index0 }}" placeholder="Type one word">
        </div>
      {% endfor %}
    </div>
    {% endif %}

    <!-- Writing -->
    {% if writing %}
    <div class="card-glass p-4 mb-4">
      <div class="section-title">E. Writing (2 prompts)</div>
      {% for w in writing %}
        <div class="mb-3">
          <div class="fw-semibold mb-1">{{ loop.index }}. {{ w.prompt }}</div>
          {% if w.required_words %}
            <div class="mb-2">
              {% for rw in w.required_words %}
                <span class="badge-soft me-1">{{ rw }}</span>
              {% endfor %}
            </div>
          {% endif %}
          <textarea name="long_{{ loop.index0 }}" class="form-control" placeholder="Write one clear sentence using the words above." style="min-height:110px;"></textarea>
        </div>
      {% endfor %}
      <div class="small-note">Tip: Check capital letters and full stop.</div>
    </div>
    {% endif %}

    <!-- Bottom actions -->
    <div class="bottom-bar mt-2">
      <button class="btn-fun" type="submit">
        <i class="bi bi-check2-circle"></i> Submit Week {{ week }}
      </button>

      <a class="btn-fun-outline" href="{{ url_for('career_overview', ws_id=ws_id) }}">
        <i class="bi bi-arrow-left"></i> Back
      </a>
    </div>
  </form>
</div>

</body>
</html>
